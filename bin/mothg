#!/usr/bin/env python

import os, sys, urllib2

def bootstrap():
  url = "http://localhost:8080/main.zip"

  sys.stderr.write("*** "  + ZIP_PATH + " not found. Attempting to bootstrap\n***\n")
  sys.stderr.write("*** Downloading: " + url + "...")

  sys.stderr.flush()

  with open(ZIP_PATH,"w") as out:
    out.write(urllib2.urlopen(url).read())

  sys.stderr.write(" done.\n***\n\n")

SELF_DIR = os.path.dirname(__file__)
ZIP_PATH = os.path.abspath(os.path.join(SELF_DIR, "..", "main.zip"))

if os.path.exists(ZIP_PATH):
  sys.path.insert(0, ZIP_PATH)

try:
  import foo
except ImportError:
  bootstrap()

  if os.path.exists(ZIP_PATH):
    sys.path.insert(0, ZIP_PATH)

  import foo

foo.bar()


